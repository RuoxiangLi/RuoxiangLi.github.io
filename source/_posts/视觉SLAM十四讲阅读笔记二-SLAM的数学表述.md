---
title: 视觉SLAM十四讲阅读笔记二-SLAM的数学表述
date: 2018-08-05 17:06:22
tags:
  - SLAM基础
  - 读书笔记
mathjax: true
categories: SLAM
---

-----

这篇文章是视觉SLAM十四讲第2讲阅读过程中总结和记录的学习内容。

<!--more-->

## SLAM问题提出

SLAM问题可以描述为：机器人在某个未知环境中从某个未知位置开始移动，在移动过程中根据传感器数据进行自身定位估计，同时在自身定位的基础上增量式构造地图，从而实现机器人对未知环境的地图构建和在地图中对自身的位置进行定位。对于机器人来说，SLAM主要回答了两个问题：1）我在什么地方？（**定位**） 2）周围环境是怎么样的？（**建图**），即机器人一方面要明白自身的**状态（即位置）**，另一方面也要了解外在的**环境（即地图）**。

## SLAM问题的数学表述

SLAM要回答这两个问题，机器人需要通过传感器采集数据，然后根据这些数据推断出自身的位姿信息和所处的环境信息。

携带传感器的机器人在某未知环境中运动，由于相机通常是在某些时刻采集数据的，所以我们只关心这些时刻的位置和地图。这样就把一段连续时间的运动变成离散时刻$t=1,...,K$当中发生的事情。在这些时刻，用$x$表示小萝卜自身的位置。于是各时刻的位置就记为$x_1,...,x_K$，它们构成了机器人的轨迹。

地图方面，假设地图由许多个**路标（landmark）**组成，每个时刻传感器会测量到一部分路标点，设路标点一共有$N$个，用$y_1,...y_N$表示。机器人在某个时间内通过传感器获得一系列连续的传感器数据（路标点的观测数据），即观测值$z$。依据机器人所配备的传感器，观测值$z$可以是激光雷达（laser）数据、图像数据、里程计（odometer）数据和惯性导航单元（IMU）数据等。

### 运动方程

SLAM需要解决的就是通过观测值$z$评估系统状态$x$。系统状态通常包含两部分，一部分用于表示机器人在环境中的位置，另一部分用于表示环境地图。通常，机器人会携带一个测量自身运动的传感器，比如里程计。因此可以构造一个评估函数，利用当前获得的传感器数据（不一定直接就是位置之差，还可能是加速度、角速度等信息），从前一时刻的系统状态评估当前时刻的系统状态，通用、抽象的数学模型如下所示：

$x_k=f(x_{k-1},u_k,\omega_k)$

$u_k$是运动传感器的数据（或称为输入），$w_k$为噪声。这里的$f$指代一种计算模型，当输入的运动传感器类型不同时，$f$的具体形式会千差万别。我们通常把它称为**运动方程**。

### 观测方程

与运动方程相对应是**观测方程**。观测方程描述的是当机器人在$x_k$位置上利用传感器感知环境，看到了某个路标点$y_j$，产生了观测数据$z_{k,j}$。此处同样用一个抽象的函数$h$来表述这个关系：

$z_{k,j}=h(y_j,x_k,\upsilon_{k,j})$

这里$v_k$表示此次观测的噪声。由于观测所用的传感器形式更多，因此这里的观测数据$z$以及观测方程$h$也有许多不同的形式。

### 参数化过程

对于上述函数$f$、$h$，我们并没有给出具体的形式，没有具体地说明运动和观测是怎么回事，也不知道$x$、$y$、$z$如何表示的。其实根据机器人的真实运动和传感器的种类，存在着若干种**参数化（Parameterization）**方式。

举例来说，假设机器人在平面运动，其位姿由两个位置和一个转角来描述，即$x_k=[x,y,\theta]^T_k$。同时，运动传感器能够测量到机器人在任意两个时间间隔位置和转角的变化量$u_k=[\Delta x,\Delta y,\Delta \theta]^T_k$，所以运动方程就可以具体化为：

$\left[ \begin{matrix}x\\y\\\theta\end{matrix} \right]_k=\left[ \begin{matrix}x\\y\\\theta\end{matrix} \right]_{k-1}+\left[ \begin{matrix}\Delta x\\\Delta y\\\Delta \theta\end{matrix} \right]_k+\omega_k$

关于观测方程，机器人携带一个二维激光传感器，在激光传感器观测一个2D路标点时，能够测到两个量：路标点和机器人本体之间的距离$r$和夹角$\phi$，所以观测方程具体化为：

$\left[ \begin{matrix}r\\\phi\end{matrix} \right]=\left[ \begin{matrix}\sqrt{(p_x-x)^2+(p_y-y)^2}\\ arctan(\frac{p_y-y}{p_x-x})\end{matrix} \right]+\upsilon$

在视觉SLAM中，传感器是相机，那么观测方程就是“对路标点拍摄后，得到图像中的像素”的过程。该过程牵扯到相机模型的描述，在后续的阅读中再详细记录。

### 最基本的SLAM问题

综上所述，针对不同的传感器，运动和观测方程会有不同的参数化形式。如果保持它们的通用性，取成通用的抽象形式，那么SLAM过程就可以表述为两个基本方程：

$\left\{ \begin{array}{ll} x_k=f(x_{k-1},u_k,\omega_k)\\ z_{k,j}=h(y_j,x_k,\upsilon_{k,j})\end{array} \right.$

这两个方程描述了最基本的SLAM问题：当知道运动测量的读数$u$，以及传感器的读数$z$时，如果求解定位问题（估计$x$）h和建图问题（估计$y$）。即其中$z$和$u$是已知的，当选定了传感器，运动方程和观测方程也是已知的，因此SLAM求解的目标就是对$x$和$y$进行估计，使得**运动方程**和**观测方程**等式两边尽可能的成立。这时，就把SLAM问题建模为一个状态估计问题：如何通过带有噪声的测量数据，估计内部的、隐藏的状态变量。

> 疑问：观测方程和运动方程会同时用到吗？视觉SLAM只用到观测方程？？？
>
> 视觉SLAM中：
>
> - 观测方程就是“对路标点拍摄后，得到图像中的像素”的过程。
> - 运动方程？？？？

### 后续深入理解

本篇文章对SLAM问题的数学建模有了大致的了解，然而仍需深入理解一些问题。

1. 如何说明**机器人的位置$x$是什么**。对于三维空间中的机器人来说，其运动要由3个轴上的平移，以及绕着3个轴的旋转来描述，一共有6个自由度。那是否意味着随便用一个$ℝ^6$中的向量就可以描述它呢？其实并没那么简单。对6自由度的位姿（包括了旋转和平移），如何表达和优化都会在其他文章中详细介绍；
2. 视觉SLAM中观测方程如何参数化。即空间中的路标点是如何投影到一张照片上的，这就需要解释相机的成像模型；
3. 如何求解运动、观测方程。需要用到非线性优化的知识。

## SLAM问题的求解思路

从应用的角度来看，SLAM问题涉及很多方面，包括传感器的选择，对$x$的估计方式，地图的表示形式等。
从传感器的角度来讲，SLAM依赖的传感器主要包括激光传感器和视觉传感器两大类。
从X的估计方式来讲，SLAM的求解思路主要包括基于滤波的求解和基于非线性优化的求解。目前普遍认为非线性优化的方法要由于滤波方法。
从地图的表示形式来讲，SLAM得到的地图表示方式主要分为度量地图与拓扑地图，度量地图有二维，三维，稀疏，稠密等多种表现形式。